---
title: 计算1/(x^n + 1)的不定积分
date: 2025-12-16 09:59:03
categories: 数学
tags: 不定积分
cover: https://image.0xc0de.top/file/1768983199654_cover.jpeg
mathjax: true 
---

在CKKS中提到了一类特殊的分园多项式：$\Phi\_{2n} = x^n + 1 = \prod\_{k=1}^n\left(x - e^{i\pi\cdot\frac{2k - 1}{n}}\right)$，或者，换个好理解的方法，由欧拉公式：

\begin{equation}
e^{i\theta} = \cos{\theta} + i\sin{\theta}, i = \sqrt{-1}
\end{equation}

得$e^{i(2k\pi - \pi)}+1=0, k \in [1, n]$，故$e^{ n \cdot \left (i\pi\cdot\frac{2k - 1}{n}\right)}+1=0$，令$\xi\_k=e^{i\pi\cdot\frac{2k - 1}{n} }$，则 $(\xi\_k)^n+1 = 0$，故：

\begin{equation}
\frac{1}{x^n + 1} = \frac{1}{\prod\_{k=1}^n\left(x - \xi\_k\right)}
\end{equation}

故可以利用因式分解的方法计算出：

\begin{equation}
\int \frac{1}{x^n + 1} \text{d}x, n\in\mathbb{N}^+
\end{equation}


假设：

\begin{equation}
\frac{1}{x^n + 1} = \frac{1}{\prod\_{k=1}^n\left(x - \xi\_k\right)} = \sum\_{k=1}^n\frac{a\_k}{x-\xi\_k}
\end{equation}

则：

\begin{align}
1 &= \sum\_{k=1}^n\frac{a\_k\left(x^n + 1\right)}{x-\xi\_k}\\\\
&=\sum\_{k=1}^n \lim\_{x \to \xi\_l} \frac{a\_k\left(x^n + 1\right)}{x-\xi\_k}
\end{align}

由于 $(\xi\_k)^n+1 = 0$，故：

\begin{align}
\sum\_{k=1，k \ne l}^n \lim\_{x \to \xi\_l} \frac{a\_k\left(x^n + 1\right)}{x-\xi\_k} &= 0
\end{align}

\begin{align}
\sum\_{k=1}^n \lim\_{x \to \xi\_l} \frac{a\_k\left(x^n + 1\right)}{x-\xi\_k} &= \lim\_{x \to \xi\_l} \frac{a\_l\left(x^n + 1\right)}{x-\xi\_l}\xlongequal[]{\text{L'Hospital}}a\_ln\lim\_{x \to \xi\_l}x^{n-1} \\\\
&=a\_ln\frac{(\xi\_k)^n}{\xi\_k} = a\_ln\frac{-1}{\xi\_k} = 1
\end{align}

解得 $a\_l = -\xi\_k / n$，则：

\begin{align}
\frac{1}{x^n + 1} &= -\frac{1}{n}\sum\_{k=1}^n\frac{\xi\_k}{x-\xi\_k}
\end{align}

\begin{align}
\int\frac{1}{x^n + 1}\text{d}x &= \int-\frac{1}{n}\sum\_{k=1}^n\frac{\xi\_k}{x-\xi\_k}\text{d}x\\\\
&= -\frac{1}{n}\sum\_{k=1}^n\xi\_k\int\frac{1}{x-\xi\_k}\text{d}x\\\\
&= -\frac{1}{n}\sum\_{k=1}^n\xi\_k\ln\left(x-\xi\_k\right)\ + C
\end{align}

若想消去$\xi\_k$，先讨论$n$为偶数的情况。设$n = 2m, m\in\mathbb{N}^+$，则$\bar{\xi\_k} = \xi\_{2m - k + 1}$，故$\xi\_k \cdot \xi\_{2m - k + 1} = 1$, $\xi\_k + \xi\_{2m - k + 1} = 2\cos\left(\frac{2k - 1}{2m}\pi\right)$，令$\theta\_k=\frac{2k - 1}{2m}\pi$，则有：

\begin{align}
\frac{1}{x^{2m} + 1} =& -\frac{1}{2m}\sum\_{k=1}^{2m}\frac{\xi\_k}{x-\xi\_k} = -\frac{1}{2m}\sum\_{k=1}^{m}\left(\frac{\xi\_k}{x-\xi\_k} + \frac{\xi\_{2m - k + 1}}{x-\xi\_{2m - k + 1}}\right)\\\\
=& -\frac{1}{2m}\sum\_{k=1}^{m}\frac{\xi\_k\cdot x-\xi\_k \cdot \xi\_{2m - k + 1} + \xi\_{2m - k + 1}\cdot x- \xi\_k \cdot \xi\_{2m - k + 1}}{(x-\xi\_k)(x-\xi\_{2m - k + 1})}\\\\
=& -\frac{1}{2m}\sum\_{k=1}^{m}\frac{x\left(\xi\_k + \xi\_{2m - k + 1}\right) - 2}{x^2-x\left(\xi\_k + \xi\_{2m - k + 1}\right) + \xi\_k \cdot \xi\_{2m - k + 1}}\\\\
=& \frac{1}{m}\sum\_{k=1}^{m}\frac{1 - x\cos\theta\_k}{x^2-2x\cos\theta\_k+1}
\end{align}

\begin{align}
\int \frac{1}{x^{2m} + 1}\text{d}x =& \frac{1}{m}\sum\_{k=1}^{m}\int\frac{1 - x\cos\theta\_k}{x^2-2x\cos\theta\_k+1}\text{d}x\\\\
=& \frac{1}{m}\sum\_{k=1}^{m}\int\frac{\cos^2\theta\_k + \sin^2\theta\_k - x\cos\theta\_k}{x^2-2x\cos\theta\_k+1}\text{d}x\\\\
=& \frac{1}{m}\sum\_{k=1}^{m}\int\frac{\sin^2\theta\_k}{x^2-2x\cos\theta\_k+1}\text{d}x+\frac{1}{2m}\sum\_{k=1}^{m}\cos\theta\_k\int\frac{2\cos\theta\_k - 2x}{x^2-2x\cos\theta\_k+1}\text{d}x\\\\
=& \frac{1}{m}\sum\_{k=1}^{m}\sin^2\theta\_k\int\frac{\text{d}x}{\left(x^2-\cos\theta\_k\right)^2 +\sin^2\theta\_k}-\frac{1}{2m}\sum\_{k=1}^{m}\cos\theta\_k\int\frac{\text{d}(x^2 - 2x\cos\theta\_k + 1)}{x^2-2x\cos\theta\_k+1}\\\\
=& \frac{1}{m}\sum\_{k=1}^{m}\sin\theta\_k\arctan\frac{x-\cos\theta\_k}{\sin\theta\_k}-\frac{1}{2m}\sum\_{k=1}^{m}\cos\theta\_k\ln\left|x^2-2x\cos\theta\_k+1\right| + C\\\\
=& \frac{1}{m}\sum\_{k=1}^{m}\sin\left(\frac{2k - 1}{2m}\pi\right)\cdot\arctan\frac{x-\cos\left(\frac{2k - 1}{2m}\pi\right)}{\sin\left(\frac{2k - 1}{2m}\pi\right)}\\\\
&-\frac{1}{2m}\sum\_{k=1}^{m}\cos\left(\frac{2k - 1}{2m}\pi\right)\cdot\ln\left|x^2-2x\cos\left(\frac{2k - 1}{2m}\pi\right)+1\right| + C
\end{align}

再讨论$n$为奇数的情况。设$n = 2m+1, m\in\mathbb{N}^+$，则$\bar{\xi\_k} = \xi\_{2m - k + 2}$，多出一项$\xi\_{m + 1} = -1$，令$\theta\_k=\frac{2k - 1}{2m+1}\pi$则：

\begin{align}
\frac{1}{x^{2m+1} + 1} =& -\frac{1}{2m+1}\sum\_{k=1}^{2m+1}\frac{\xi\_k}{x-\xi\_k}\\\\
=&\frac{1}{(2m+1)(x+1)} -\frac{1}{2m+1}\sum\_{k=1}^{m}\left(\frac{\xi\_k}{x-\xi\_k} + \frac{\xi\_{2m - k + 2}}{x-\xi\_{2m - k + 2}}\right)\\\\
=&\frac{1}{(2m+1)(x+1)} +\frac{2}{2m+1}\sum\_{k=1}^{m}\frac{1 - x\cos\theta\_k}{x^2-2x\cos\theta\_k+1}
\end{align}

\begin{align}
\int\frac{1}{x^{2m+1} + 1}\text{d}x=&\int\frac{1}{(2m+1)(x+1)}\text{d}x+\frac{2}{2m+1}\sum\_{k=1}^{m}\int\frac{1 - x\cos\theta\_k}{x^2-2x\cos\theta\_k+1}\text{d}x\\\\
=&\frac{\ln\left|x+1\right|}{2m+1}+\frac{2}{2m+1}\sum\_{k=1}^{m}\sin\left(\frac{2k - 1}{2m+1}\pi\right)\cdot\arctan\frac{x-\cos\left(\frac{2k - 1}{2m+1}\pi\right)}{\sin\left(\frac{2k - 1}{2m+1}\pi\right)}\\\\
&-\frac{1}{2m+1}\sum\_{k=1}^{m}\cos\left(\frac{2k - 1}{2m+1}\pi\right)\cdot\ln\left|x^2-2x\cos\left(\frac{2k - 1}{2m+1}\pi\right)+1\right| + C
\end{align}